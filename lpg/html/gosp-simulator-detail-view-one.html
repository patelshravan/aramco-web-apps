<!DOCTYPE html>
<html lang="en">
  <head>
    <title>GOSP Simulator</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="csrf-token" content="{{ csrf_token() }}" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
    />

    <link rel="icon" type="image/x-icon" href="../img/favicon.ico" />

    <link rel="stylesheet" href="../css/bootstrap.min.css" />

    <script src="../js/jquery.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>

    <!-- Toast -->
    <link rel="stylesheet" href="../css/toastr.min.css" />
    <script src="../js/toastr.min.js"></script>

    <link rel="stylesheet" href="../css/fontawesome-all.min.css" />

    <script>
      window.jQuery ||
        document.write(
          decodeURIComponent('%3Cscript src="js/jquery.min.js"%3E%3C/script%3E')
        );
    </script>

    <script src="../js/dx.all.js"></script>
    <script src="../js/moment.min.js"></script>
    <link rel="stylesheet" href="../css/dx.light.css" />
    <link rel="stylesheet" href="../css/gosp-simulator-detail-view-one.css" />
    <link rel="stylesheet" type="text/css" href="../css/styles.css" />
    <script type="text/javascript" src="../js/Chart.min.js"></script>
  </head>

  <body class="dx-viewport">
    <div id="allComments"></div>
    <div id="popup">
      <div id="popup-textarea-container"></div>
      <div id="popup-submit-button"></div>
    </div>
    <header id="app-header">
      <a href="./gosp-simulator.html"><i class="fa fa-home fa-2x"></i></a>
      <div class="ml-2 title">
        GOSP SimulatorÂ  &nbsp;
        <span class="" id="datepicker1"></span>
      </div>
      <img src="../img/SA_logo.jpg" alt="logo" class="logo" />
    </header>
    <div class="header-border"></div>
    <div class="overlay">
      <svg
        class="hourglass-icon"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 120 206"
        preserveAspectRatio="none"
      >
        <path
          class="middle"
          d="M120 0H0v206h120V0zM77.1 133.2C87.5 140.9 92 145 92 152.6V178H28v-25.4c0-7.6 4.5-11.7 14.9-19.4 6-4.5 13-9.6 17.1-17 4.1 7.4 11.1 12.6 17.1 17zM60 89.7c-4.1-7.3-11.1-12.5-17.1-17C32.5 65.1 28 61 28 53.4V28h64v25.4c0 7.6-4.5 11.7-14.9 19.4-6 4.4-13 9.6-17.1 16.9z"
        />
        <path
          class="outer"
          d="M93.7 95.3c10.5-7.7 26.3-19.4 26.3-41.9V0H0v53.4c0 22.5 15.8 34.2 26.3 41.9 3 2.2 7.9 5.8 9 7.7-1.1 1.9-6 5.5-9 7.7C15.8 118.4 0 130.1 0 152.6V206h120v-53.4c0-22.5-15.8-34.2-26.3-41.9-3-2.2-7.9-5.8-9-7.7 1.1-2 6-5.5 9-7.7zM70.6 103c0 18 35.4 21.8 35.4 49.6V192H14v-39.4c0-27.9 35.4-31.6 35.4-49.6S14 81.2 14 53.4V14h92v39.4C106 81.2 70.6 85 70.6 103z"
        />
      </svg>
    </div>

    <div class="container-fluid">
      <div class="row align-items-center mt-2 flex-nowrap overflow-auto">
        <div
          class="col-auto bottom-buttons d-flex align-items-center flex-shrink-0"
        >
          <!-- Group 1 -->
          <button
            id="openButton"
            class="btn btn-primary btn-sm icon-btn-square"
            title="Open Scenario"
          >
            <i class="fas fa-folder-open"></i>
          </button>
          <button
            id="saveButton"
            class="btn btn-success btn-sm icon-btn-square"
            title="Save"
          >
            <i class="fas fa-save"></i>
          </button>
          <button
            id="saveAsButton"
            class="btn btn-danger btn-sm icon-btn-square"
            title="Save As"
          >
            <i class="fas fa-copy"></i>
          </button>

          <!-- Group 2 -->
          <button
            id="fetchLatestDataBtn"
            class="btn btn-info btn-sm icon-btn-square ml-4"
            title="Fetch Latest Data"
            disabled
          >
            <i class="fas fa-sync-alt"></i>
          </button>

          <button
            id="compareScenariosBtn"
            class="btn btn-dark btn-sm icon-btn-square"
            title="Compare Scenarios"
            disabled
          >
            <i class="fas fa-balance-scale"></i>
          </button>
          <button
            id="notifyOSPASBtn"
            class="btn btn-warning btn-sm icon-btn-square"
            title="Notify OSPAS"
          >
            <i class="fas fa-bell"></i>
          </button>
          <button
            id="gaugeFactorBtn"
            class="btn btn-danger btn-sm icon-btn-square"
            title="Gauge Factor"
          >
            <i class="fas fa-tachometer-alt"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- OPEN DROPDOWN -->
    <div
      class="modal fade"
      id="openVersionModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="openVersionModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Open Saved Version</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span>&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label for="versionSelect">Select a Version</label>
              <select class="form-control" id="versionSelect"></select>
            </div>
            <div
              id="noVersionsMessage"
              class="text-muted"
              style="display: none"
            >
              No saved versions available.
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
            >
              Cancel
            </button>
            <button
              id="confirmOpenVersion"
              type="button"
              class="btn btn-primary"
            >
              Open
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- SAVE AS POPUP -->
    <div
      class="modal fade"
      id="saveAsModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="saveAsModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Save As</h5>
            <button
              type="button"
              class="close btn-close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span>&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form id="saveAsForm">
              <div class="form-group">
                <label for="saveName"
                  >Name <span style="color: red">*</span></label
                >
                <input
                  type="text"
                  class="form-control"
                  id="saveName"
                  required
                />
              </div>
              <div class="form-group">
                <label for="saveDescription">Description</label>
                <textarea
                  class="form-control"
                  id="saveDescription"
                  rows="3"
                ></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary btn-cancel"
              data-dismiss="modal"
            >
              Cancel
            </button>
            <button
              id="saveAsSubmitBtn"
              type="submit"
              form="saveAsForm"
              class="btn btn-primary"
            >
              <span
                class="spinner-border spinner-border-sm d-none"
                role="status"
                aria-hidden="true"
                id="saveAsLoadingSpinner"
              ></span>
              <span id="saveAsBtnText">Save</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- NOTIFY OSPAS -->
    <div
      class="modal fade"
      id="notifyOSPASModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="notifyOSPASLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="notifyOSPASLabel">Notify OSPAS</h5>
            <button
              type="button"
              class="close btn-close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span>&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <textarea
              id="ospasComment"
              class="form-control"
              rows="4"
              placeholder="Enter comment..."
            ></textarea>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary btn-cancel"
              data-dismiss="modal"
            >
              Cancel
            </button>
            <button type="button" class="btn btn-primary" id="sendOSPASBtn">
              <span
                class="spinner-border spinner-border-sm d-none"
                id="ospasSpinner"
              ></span>
              <span id="ospasBtnText">Send</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="separator-line"></div>

    <!-- KPIs and Buttons Section -->
    <div class="container-fluid mt-3">
      <div class="row align-items-center justify-content-between gx-2">
        <!-- KPI Scroll Section -->
        <div class="col overflow-auto ml-3" id="kpiScrollContainer">
          <!-- KPI cards will be injected dynamically -->
        </div>

        <!-- Action Buttons -->
        <div class="col-auto d-flex align-items-center gap-20">
          <!-- Area Selection Box -->
          <div class="area-box border rounded p-3 bg-white shadow-sm me-3">
            <div class="mb-2 fw-bold text-primary">Select Areas:</div>
            <div id="areaFilterContainer"></div>
          </div>
          <button
            class="btn btn-xs btn-outline-warning"
            title="Reset Adjustments"
            id="resetAdjustmentsBtn"
          >
            <i class="fa fa-undo me-1"></i> Reset Adjustments
          </button>
        </div>
      </div>
    </div>

    <!-- ðŸ” Reset Confirmation Modal -->
    <div
      class="modal fade"
      id="resetAdjustmentsConfirmModal"
      tabindex="-1"
      aria-labelledby="resetAdjustmentsConfirmLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-warning text-dark">
            <h5 class="modal-title" id="resetAdjustmentsConfirmLabel">
              Confirm Reset
            </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            Are you sure you want to reset all adjustments? This action cannot
            be undone.
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-warning"
              id="confirmResetAdjustmentsBtn"
            >
              Yes, Reset
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Main DataGrid -->
    <div class="container-fluid mt-3">
      <div class="row">
        <div class="col">
          <div id="tabpanel">
            <div id="gospGrid1"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Gauge Factor Modal -->
    <div
      class="modal fade"
      id="gaugeFactorModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="gaugeFactorModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="gaugeFactorModalLabel">Gauge Factor</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>GOSP</th>
                  <th>Factor</th>
                </tr>
              </thead>
              <tbody id="gaugeFactorTableBody">
                <!-- Rows will be dynamically populated -->
              </tbody>
            </table>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-success"
              id="saveGaugeFactorBtn"
            >
              Save
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="updateGaugeFactorBtn"
            >
              Update
            </button>
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <script
      type="module"
      src="../js/gosp-simulator-detail-view-one.js"
    ></script>
  </body>
</html>
